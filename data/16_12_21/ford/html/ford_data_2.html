<script>
    window.addEventListener('load', function () {
        if (typeof dataLayer !== 'undefined') {
            let products = [{ "id": 24772, "name": "BB53-5L220-AB", "ref": "1251494X", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "FoMoCo", "type": "Ceramic", "PT": 0, "PD": 1800, "RH": 150, "price": 121.03401108030809 }, { "id": 24465, "name": "XF22 AF WRA", "ref": "5F250 \/ OLD WINDSTAR NO SENSOR", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 0.7, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 0, "PD": 2300, "RH": 200, "price": 110.52074379235307 }, { "id": 24978, "name": "1536322X", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 0.954, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "FoMoCo", "type": "Ceramic", "PT": 0, "PD": 2000, "RH": 84, "price": 105.16602320405332 }, { "id": 25492, "name": "GK21-5K224-AB", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 0.5, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 0, "PD": 0, "RH": 0, "price": 0 }, { "id": 25721, "name": "CCW 022", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 0.56, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 7205, "PD": 0, "RH": 0, "price": 98.85376477654516 }, { "id": 26304, "name": "YL84-5F223-BA", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 0.86, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 462, "PD": 0, "RH": 216, "price": 62.70189861708051 }, { "id": 26141, "name": "CC11-5H220-BC CC11-5K286-CC", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 3.228, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic + DPF", "PT": 714, "PD": 618, "RH": 0, "price": 136.33248974903438 }, { "id": 26222, "name": "V91BB-5F228 V92BB-5F228", "ref": "A1a\/A2A", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Steel", "PT": 200, "PD": 300, "RH": 150, "price": 59.994841270421176 }, { "id": 23642, "name": "GK21-5K224-BB", "ref": "1719833X", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 0.55, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "DPF", "PT": 0, "PD": 0, "RH": 0, "price": 0 }, { "id": 19081, "name": "XF22 AF NRA", "ref": "STEP REG", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 200, "PD": 1200, "RH": 100, "price": 84.75601255047297 }, { "id": 19082, "name": "XF22 JLN", "ref": "STEP REG", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 400, "PD": 2000, "RH": 250, "price": 169.48310406458202 }, { "id": 19106, "name": "F5223E8", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 400, "PD": 2100, "RH": 200, "price": 159.0363113183696 }, { "id": 19284, "name": "62270102", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 1500, "PD": 900, "RH": 200, "price": 133.5910603454449 }, { "id": 19129, "name": "F6S223AC", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 700, "PD": 400, "RH": 100, "price": 61.98745537260495 }, { "id": 19153, "name": "EA221", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 500, "PD": 1400, "RH": 200, "price": 130.71722416506762 }, { "id": 22941, "name": "2F22 5F250 AA", "ref": "OPPOSITE", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 600, "PD": 1600, "RH": 200, "price": 142.00709654131293 }, { "id": 23337, "name": "F57223AA", "ref": "Ford FRONT", "brand": "ford", "brands": "ford", "monolithe": null, "weight": 0.91, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 0, "PD": 2600, "RH": 300, "price": 182.71465926810342 }, { "id": 23343, "name": "YL84-5F227-AA", "ref": null, "brand": "ford", "brands": "ford", "monolithe": null, "weight": 1.18, "years": [], "enabled": true, "brandNames": "Ford", "brandSlugs": "ford", "blockAddingNewPictures": false, "catalytic": "-", "type": "Ceramic", "PT": 900, "PD": 0, "RH": 350, "price": 145.8458492686441 }];
            let impressions = [];

            products.forEach(function (product, index) {
                return impressions[index] = {
                    'id': product.id,
                    'name': product.name,
                    'price': product.price,
                    'brand': product.brandNames,
                    'list': 'Search Results',
                    'position': index
                };
            });

            dataLayer.push({
                'ecommerce': {
                    'currencyCode': "United Kingdom Pound (GBP)",
                    'impressions': impressions
                }
            });
        }
    });

    
</script>